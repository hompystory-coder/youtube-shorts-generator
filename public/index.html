
    <!DOCTYPE html>
    <html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>ìœ íŠœë¸Œ ì‡¼ì¸  ìë™ ìƒì„±ê¸°</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
        
        <!-- Google Fonts - Korean subset only (ê²€ì¦ëœ í•œê¸€ í°íŠ¸) -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@700&family=Black+Han+Sans&family=Jua&family=Gamja+Flower&family=Do+Hyeon&display=swap&subset=korean" rel="stylesheet">
        
        <style>
            .progress-step { @apply relative flex-1 text-center; }
            .progress-step.active .step-circle { @apply bg-blue-600 text-white border-blue-600; }
            .progress-step.completed .step-circle { @apply bg-green-600 text-white border-green-600; }
            .step-circle { @apply w-10 h-10 rounded-full border-2 border-gray-300 flex items-center justify-center mx-auto mb-2 bg-white transition-all; }
            .loading { animation: spin 1s linear infinite; }
            @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        </style>
    </head>
    <body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen">
        <!-- Hidden input fields for API keys (loaded from mypage settings) -->
        <input type="hidden" id="geminiApiKey" value="">
        <input type="hidden" id="minimaxApiKey" value="">
        <input type="hidden" id="minimaxGroupId" value="">
        <input type="hidden" id="shotstackApiKey" value="">
        
        <div class="container mx-auto px-4 py-8 max-w-6xl">
            <!-- Header -->
            <div class="mb-8">
                <div class="flex justify-between items-center mb-4 flex-wrap gap-4">
                    <div>
                        <h1 class="text-4xl font-bold text-gray-800 mb-2">
                            <i class="fas fa-video mr-3 text-red-600"></i>
                            ìœ íŠœë¸Œ ì‡¼ì¸  ìë™ ìƒì„±ê¸°
                        </h1>
                        <p class="text-gray-600">ë¸”ë¡œê·¸ ê¸€ì„ ì…ë ¥í•˜ë©´ ìë™ìœ¼ë¡œ ìœ íŠœë¸Œ ì‡¼ì¸  ì˜ìƒì´ ìƒì„±ë©ë‹ˆë‹¤</p>
                    </div>
                    
                    <div class="flex gap-2 sm:gap-3 items-center flex-wrap">
                        <!-- í”Œëœë³´ê¸° ë²„íŠ¼ (í•­ìƒ í‘œì‹œ - ë¡œê·¸ì¸ ì—¬ë¶€ ë¬´ê´€) -->
                        <button 
                            id="pricingButton"
                            onclick="showPricingModal()"
                            class="px-3 sm:px-4 py-2 sm:py-2.5 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg hover:from-purple-600 hover:to-pink-700 transition flex items-center gap-2 shadow-lg whitespace-nowrap text-sm sm:text-base cursor-pointer">
                            <i class="fas fa-crown"></i>
                            <span class="font-medium">í”Œëœë³´ê¸°</span>
                        </button>
                        
                        <!-- Auth Buttons -->
                        <div id="authButtons" class="flex gap-2 sm:gap-3 items-center flex-wrap">
                        <!-- Loading state -->
                        <div id="authLoading" class="flex items-center gap-2">
                            <i class="fas fa-spinner fa-spin text-gray-400"></i>
                            <span class="text-sm text-gray-500">í™•ì¸ ì¤‘...</span>
                        </div>
                        
                        <!-- Not logged in -->
                        <div id="authNotLoggedIn" class="hidden flex items-center gap-2 sm:gap-3">
                            <a href="/login.html" 
                                class="px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 shadow-md text-sm whitespace-nowrap">
                                <i class="fas fa-sign-in-alt"></i>
                                <span class="font-medium">ë¡œê·¸ì¸</span>
                            </a>
                            <a href="/signup.html" 
                                class="px-3 sm:px-4 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg hover:from-green-700 hover:to-emerald-700 transition flex items-center gap-2 shadow-md text-sm whitespace-nowrap">
                                <i class="fas fa-user-plus"></i>
                                <span class="font-medium">íšŒì›ê°€ì…</span>
                            </a>
                        </div>
                        
                        <!-- Logged in -->
                        <div id="authLoggedIn" class="hidden flex items-center gap-2 sm:gap-3 flex-wrap">
                            <!-- Subscription Status Badge -->
                            <div id="subscriptionBadge" class="hidden px-3 py-2 rounded-lg shadow-md cursor-pointer hover:shadow-lg transition" onclick="showPricingModal()">
                                <div class="flex items-center gap-2">
                                    <i class="fas fa-crown text-sm"></i>
                                    <div>
                                        <p class="text-xs font-semibold" id="subscriptionText">ë¡œë”© ì¤‘...</p>
                                        <p class="text-xs" id="subscriptionDays"></p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex items-center gap-2 bg-white px-3 py-2 rounded-lg shadow-sm border border-gray-200">
                                <img id="userPicture" src="" alt="Profile" class="w-7 h-7 sm:w-8 sm:h-8 rounded-full hidden">
                                <div class="text-right hidden sm:block">
                                    <p id="userName" class="text-sm font-semibold text-gray-800"></p>
                                    <p id="userEmail" class="text-xs text-gray-500"></p>
                                </div>
                                <span id="userRole" class="px-2 py-1 text-xs font-semibold rounded-full"></span>
                            </div>
                            <!-- Admin Button (only for hompystory@gmail.com) -->
                            <a href="/admin" 
                                id="adminButton"
                                class="hidden px-3 sm:px-4 py-2 bg-gradient-to-r from-red-600 to-orange-600 text-white rounded-lg hover:from-red-700 hover:to-orange-700 transition flex items-center gap-2 shadow-md text-sm whitespace-nowrap">
                                <i class="fas fa-shield-alt"></i>
                                <span class="font-medium hidden sm:inline">ê´€ë¦¬ì</span>
                            </a>
                            <a href="/mypage" 
                                class="px-3 sm:px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition flex items-center gap-2 shadow-md text-sm whitespace-nowrap">
                                <i class="fas fa-user-circle"></i>
                                <span class="font-medium hidden sm:inline">ë§ˆì´í˜ì´ì§€</span>
                            </a>
                            <button onclick="handleLogout()" 
                                class="px-3 sm:px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition flex items-center gap-2 shadow-md text-sm whitespace-nowrap">
                                <i class="fas fa-sign-out-alt"></i>
                                <span class="font-medium hidden sm:inline">ë¡œê·¸ì•„ì›ƒ</span>
                            </button>
                        </div>
                        </div> <!-- authButtons ë -->
                    </div> <!-- flex container ë -->
                </div> <!-- header ë -->
            </div>

            <!-- êµ¬ë… ì•ˆë‚´ ë°°ë„ˆ -->
            <div id="subscriptionBanner" class="hidden mb-6 bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500 rounded-lg shadow-xl p-6 text-white">
                <div class="flex items-center justify-between">
                    <div class="flex-1">
                        <h3 class="text-2xl font-bold mb-2">
                            <i class="fas fa-star mr-2"></i>
                            í”„ë¦¬ë¯¸ì—„ êµ¬ë…ìœ¼ë¡œ ë” ë§ì€ ê¸°ëŠ¥ì„!
                        </h3>
                        <p class="text-white/90">ë¬´ë£Œ ì²´í—˜ 3ì¼ + ì›” 33,000ì› / ì—° 297,000ì› (25% í• ì¸)</p>
                    </div>
                    <a href="/payment.html" class="ml-4 px-8 py-4 bg-white text-orange-600 font-bold rounded-lg hover:bg-gray-100 transition shadow-lg text-lg">
                        <i class="fas fa-shopping-cart mr-2"></i>
                        êµ¬ë…í•˜ê¸°
                    </a>
                </div>
            </div>

            <!-- Main Content -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Left Panel - Settings -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-palette mr-2 text-blue-600"></i>
                            ê¸°ë³¸ ì„¤ì •
                        </h2>
                        
                        <div class="space-y-4">

                            <!-- ë°°ê²½ ì„¤ì • -->
                            <div class="mb-4 p-4 bg-gradient-to-r from-blue-50 to-purple-50 border-2 border-blue-200 rounded-lg">
                                <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2">
                                    <i class="fas fa-image text-blue-600"></i>
                                    ë°°ê²½ ì´ë¯¸ì§€ / ìŒì•…
                                </h3>
                                
                                <div class="space-y-3">
                                    <!-- ë°°ê²½ ì´ë¯¸ì§€ ì„ íƒ -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">
                                            <i class="fas fa-image mr-1"></i> ë°°ê²½ ì´ë¯¸ì§€
                                        </label>
                                        <select id="bgImageSelect" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                            <option value="">ì„ íƒ ì•ˆí•¨ (ê¸°ë³¸ ì´ë¯¸ì§€ ì‚¬ìš©)</option>
                                        </select>
                                        <p class="text-xs text-gray-500 mt-1">
                                            <a href="/mypage" class="text-blue-600 hover:underline">ë§ˆì´í˜ì´ì§€</a>ì—ì„œ ë°°ê²½ ì´ë¯¸ì§€ë¥¼ ë¨¼ì € ì—…ë¡œë“œí•´ì£¼ì„¸ìš”
                                        </p>
                                    </div>

                                    <!-- ë°°ê²½ ìŒì•… ì„ íƒ -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">
                                            <i class="fas fa-music mr-1"></i> ë°°ê²½ ìŒì•…
                                        </label>
                                        <select id="bgMusicSelect" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                            <option value="">ì„ íƒ ì•ˆí•¨ (ìŒì•… ì—†ìŒ)</option>
                                        </select>
                                        <p class="text-xs text-gray-500 mt-1">
                                            <a href="/mypage" class="text-blue-600 hover:underline">ë§ˆì´í˜ì´ì§€</a>ì—ì„œ ë°°ê²½ ìŒì•…ì„ ë¨¼ì € ì—…ë¡œë“œí•´ì£¼ì„¸ìš”
                                        </p>
                                    </div>
                                </div>
                            </div>

                            <!-- Minimax ìŒì„± ë¯¸ë¦¬ë“£ê¸° -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">
                                    <i class="fas fa-microphone mr-1"></i> Minimax ìŒì„± ì„ íƒ
                                </label>
                                <select id="minimaxVoiceSelect" 
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm mb-2">
                                    <option value="Friendly_Person" selected>ì¹œê·¼í•œ ëª©ì†Œë¦¬ (Friendly Person)</option>
                                    <option value="Calm_Woman">ì°¨ë¶„í•œ ì—¬ì„± (Calm Woman)</option>
                                    <option value="Wise_Woman">ì§€í˜œë¡œìš´ ì—¬ì„± (Wise Woman)</option>
                                    <option value="Lively_Girl">í™œê¸°ì°¬ ì†Œë…€ (Lively Girl)</option>
                                    <option value="Sweet_Girl_2">ë‹¬ì½¤í•œ ì†Œë…€ (Sweet Girl)</option>
                                    <option value="Lovely_Girl">ì‚¬ë‘ìŠ¤ëŸ¬ìš´ ì†Œë…€ (Lovely Girl)</option>
                                    <option value="Casual_Guy">ìºì£¼ì–¼í•œ ë‚¨ì„± (Casual Guy)</option>
                                    <option value="Deep_Voice_Man">ì €ìŒ ë‚¨ì„± (Deep Voice Man)</option>
                                    <option value="Patient_Man">ì¹¨ì°©í•œ ë‚¨ì„± (Patient Man)</option>
                                    <option value="Determined_Man">ë‹¨í˜¸í•œ ë‚¨ì„± (Determined Man)</option>
                                    <option value="Young_Knight">ì Šì€ ê¸°ì‚¬ (Young Knight)</option>
                                    <option value="Elegant_Man">ìš°ì•„í•œ ë‚¨ì„± (Elegant Man)</option>
                                    <option value="Decent_Boy">ì ì–ì€ ì†Œë…„ (Decent Boy)</option>
                                    <option value="Inspirational_girl">ì˜ê°ì„ ì£¼ëŠ” ì†Œë…€ (Inspirational Girl)</option>
                                    <option value="Exuberant_Girl">ìƒê¸° ë„˜ì¹˜ëŠ” ì†Œë…€ (Exuberant Girl)</option>
                                    <option value="Imposing_Manner">ìœ„ì—„ ìˆëŠ” (Imposing Manner)</option>
                                    <option value="Abbess">ìˆ˜ë…€ì›ì¥ (Abbess)</option>
                                </select>
                                
                                <button type="button" id="previewVoiceBtn"
                                    onclick="previewVoice()"
                                    class="w-full px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-md hover:from-purple-600 hover:to-pink-600 transition flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed">
                                    <i class="fas fa-play" id="previewVoiceIcon"></i>
                                    <span id="previewVoiceText">ìŒì„± ë¯¸ë¦¬ë“£ê¸°</span>
                                </button>
                                
                                <audio id="voicePreviewAudio" class="hidden"></audio>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-font mr-1"></i> ìë§‰ í°íŠ¸ (í•œê¸€ ì§€ì›) - ê¸°ë³¸ê°’
                                </label>
                                <select id="fontSelect" 
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <optgroup label="ğŸ‡°ğŸ‡· ê²€ì¦ëœ í•œê¸€ í°íŠ¸ (ë¡œì»¬ í˜¸ìŠ¤íŒ…)">
                                        <option value="Noto Sans KR" selected>Noto Sans KR - ê¸°ë³¸ ê³ ë”•ì²´</option>
                                        <option value="Black Han Sans">Black Han Sans - ê°•í•œ ì„íŒ©íŠ¸</option>
                                        <option value="Jua">Jua - ë‘¥ê¸€ê³  ê·€ì—¬ìš´</option>
                                        <option value="Gamja Flower">Gamja Flower - ì†ê¸€ì”¨ì²´</option>
                                        <option value="Do Hyeon">Do Hyeon - ê¹”ë”í•œ íƒ€ì´í‹€ìš©</option>
                                    </optgroup>
                                </select>
                                <p class="text-xs text-gray-500 mt-1">
                                    ğŸ’¡ íŒŒíŠ¸ë³„ë¡œ ë‹¤ë¥¸ í°íŠ¸ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ìŠ¤í¬ë¦½íŠ¸ í¸ì§‘ ë‹¨ê³„ì—ì„œ ê° íŒŒíŠ¸ë§ˆë‹¤ í°íŠ¸ë¥¼ ì„ íƒí•˜ì„¸ìš”.
                                </p>
                                
                                <!-- í°íŠ¸ ë¯¸ë¦¬ë³´ê¸° -->
                                <div id="fontPreview" class="mt-2 p-3 bg-gray-900 rounded-lg text-center">
                                    <p id="fontPreviewText" style="color: white; font-size: 24px;">
                                        ì•ˆë…•í•˜ì„¸ìš”! YouTube Shorts
                                    </p>
                                </div>
                            </div>

                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        <i class="fas fa-text-height mr-1"></i> ìë§‰ í¬ê¸°
                                    </label>
                                    <select id="fontSizeSelect" 
                                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="40">ì‘ê²Œ (40px)</option>
                                        <option value="56" selected>ì¤‘ê°„ (56px)</option>
                                        <option value="72">í¬ê²Œ (72px)</option>
                                        <option value="96">ë§¤ìš° í¬ê²Œ (96px)</option>
                                        <option value="120">ì´ˆëŒ€í˜• (120px)</option>
                                    </select>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        <i class="fas fa-palette mr-1"></i> ìë§‰ ìƒ‰ìƒ
                                    </label>
                                    <select id="fontColorSelect" 
                                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="white" selected>í°ìƒ‰</option>
                                        <option value="yellow">ë…¸ë€ìƒ‰</option>
                                        <option value="#00ff00">ë…¹ìƒ‰</option>
                                        <option value="#ff69b4">ë¶„í™ìƒ‰</option>
                                        <option value="#00bfff">í•˜ëŠ˜ìƒ‰</option>
                                        <option value="red">ë¹¨ê°„ìƒ‰</option>
                                        <option value="orange">ì£¼í™©ìƒ‰</option>
                                    </select>
                                </div>
                            </div>

                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        <i class="fas fa-adjust mr-1"></i> ê·¸ë¦¼ì íš¨ê³¼
                                    </label>
                                    <select id="textShadowSelect" 
                                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="none">ì—†ìŒ</option>
                                        <option value="light" selected>ê°€ë²¼ìš´ ê·¸ë¦¼ì</option>
                                        <option value="medium">ì¤‘ê°„ ê·¸ë¦¼ì</option>
                                        <option value="heavy">ê°•í•œ ê·¸ë¦¼ì</option>
                                        <option value="glow">ë°œê´‘ íš¨ê³¼</option>
                                    </select>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">
                                        <i class="fas fa-square mr-1"></i> ë°°ê²½ ìŠ¤íƒ€ì¼
                                    </label>
                                    <select id="captionBgSelect" 
                                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="none" selected>ì—†ìŒ</option>
                                        <option value="semi">ë°˜íˆ¬ëª… ê²€ì •</option>
                                        <option value="solid">ë¶ˆíˆ¬ëª… ê²€ì •</option>
                                        <option value="blur">ë¸”ëŸ¬ íš¨ê³¼</option>
                                    </select>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-bold mr-1"></i> ê¸€ì êµµê¸°
                                </label>
                                <select id="fontWeightSelect" 
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="normal">ë³´í†µ</option>
                                    <option value="bold" selected>êµµê²Œ</option>
                                    <option value="bolder">ë§¤ìš° êµµê²Œ</option>
                                    <option value="900">ì´ˆêµµê²Œ</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-align-center mr-1"></i> ìë§‰ ìœ„ì¹˜
                                </label>
                                <select id="captionPositionSelect" 
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="top">ìƒë‹¨</option>
                                    <option value="center" selected>ì¤‘ì•™</option>
                                    <option value="bottom">í•˜ë‹¨</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-magic mr-1"></i> ìë§‰ ì• ë‹ˆë©”ì´ì…˜
                                </label>
                                <select id="captionAnimationSelect" 
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="fadeIn" selected>í˜ì´ë“œ ì¸</option>
                                    <option value="slideUp">ìŠ¬ë¼ì´ë“œ ì—…</option>
                                    <option value="slideDown">ìŠ¬ë¼ì´ë“œ ë‹¤ìš´</option>
                                    <option value="zoomIn">í™•ëŒ€</option>
                                    <option value="bounce">ë°”ìš´ìŠ¤</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-exchange-alt mr-1"></i> ì´ë¯¸ì§€ ì „í™˜ íš¨ê³¼
                                </label>
                                <select id="imageTransitionSelect" 
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="zoomIn" selected>ì¤Œì¸ (Zoom In)</option>
                                    <option value="zoomOut">ì¤Œì•„ì›ƒ (Zoom Out)</option>
                                    <option value="slideLeft">ì™¼ìª½ ìŠ¬ë¼ì´ë“œ</option>
                                    <option value="slideRight">ì˜¤ë¥¸ìª½ ìŠ¬ë¼ì´ë“œ</option>
                                    <option value="slideUp">ìœ„ë¡œ ìŠ¬ë¼ì´ë“œ</option>
                                    <option value="slideDown">ì•„ë˜ë¡œ ìŠ¬ë¼ì´ë“œ</option>
                                    <option value="none">íš¨ê³¼ ì—†ìŒ (None)</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-video mr-1"></i> ì˜ìƒ ìŠ¤íƒ€ì¼
                                </label>
                                <select id="videoStyleSelect" 
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="dynamic" selected>ë‹¤ì´ë‚˜ë¯¹ (ë¹ ë¥¸ ì „ê°œ)</option>
                                    <option value="calm">ì°¨ë¶„í•œ (ëŠë¦° ì „ê°œ)</option>
                                    <option value="exciting">í¥ë¶„ëœ (ì—ë„ˆì§€ ë„˜ì¹˜ëŠ”)</option>
                                    <option value="informative">ì •ë³´ ì „ë‹¬ (ëª…í™•í•œ)</option>
                                    <option value="story">ìŠ¤í† ë¦¬í…”ë§ (ê°ì„±ì )</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-comment-dots mr-1"></i> ìŠ¤í¬ë¦½íŠ¸ ìƒì„± í”„ë¡¬í”„íŠ¸
                                </label>
                                <textarea id="promptText" rows="18"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm font-mono"
                                    placeholder="ì˜ˆ: ë¸”ë¡œê·¸ ê¸€ì„ ìœ íŠœë¸Œ ì‡¼ì¸  ìŠ¤í¬ë¦½íŠ¸ë¡œ ë³€í™˜í•˜ëŠ” í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.">ë‹¹ì‹ ì€ ìœ íŠœë¸Œ ì‡¼ì¸  ë‚´ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
TTS ìŒì„± ìƒì„±ì„ ìœ„í•œ ê¹”ë”í•œ ë‚´ë ˆì´ì…˜ í…ìŠ¤íŠ¸ë§Œ ì‘ì„±í•˜ì„¸ìš”.

ì ˆëŒ€ ê¸ˆì§€ ì‚¬í•­:
- ì´ëª¨í‹°ì½˜/ì´ëª¨ì§€ ì‚¬ìš© ê¸ˆì§€
- ì¥ë©´ ì„¤ëª… ê¸ˆì§€ (ì˜ˆ: ì¥ë©´, 1-3ì´ˆ ë“±)
- ë§ˆí¬ë‹¤ìš´ í˜•ì‹ ê¸ˆì§€ (**, #, - ë“±)
- ì½œë¡  ì‚¬ìš© ê¸ˆì§€
- ì œëª©/ë¶€ì œ í˜•ì‹ ê¸ˆì§€
- íƒ€ì„ì½”ë“œ ê¸ˆì§€

ì‘ì„± ì›ì¹™:
1. ì›ë¬¸ ì¶©ì‹¤ (ë¸”ë¡œê·¸ ë‚´ìš© ê¸°ë°˜, ìƒìƒ ê¸ˆì§€)
2. ìì—°ìŠ¤ëŸ¬ìš´ ë§íˆ¬ (TTSìš© êµ¬ì–´ì²´)
3. ë¬¸ì¥ ê¸¸ì´: ê° 15-50ì
4. ì´ 6-10ê°œ ë¬¸ì¥
5. ë§ˆì¹¨í‘œë¡œë§Œ êµ¬ë¶„

ì¶œë ¥: ìˆœìˆ˜ í…ìŠ¤íŠ¸ë§Œ ì‘ì„±
ì˜ˆì‹œ: í¬ë¦¬ìŠ¤ë§ˆìŠ¤ê°€ ë‹¤ê°€ì™”ìŠµë‹ˆë‹¤. ì˜¬í•´ëŠ” íŠ¹ë³„í•œ íŠ¸ë¦¬ë¡œ ë¶„ìœ„ê¸°ë¥¼ ë‚´ë³´ì„¸ìš”. ê³ ê¸‰ìŠ¤ëŸ¬ìš´ ë¸”ë™ ì»¬ëŸ¬ê°€ ë‹ë³´ì…ë‹ˆë‹¤.</textarea>
                            </div>

                            <hr class="my-4">

                            <h3 class="font-semibold text-gray-800 mb-3">
                                <i class="fas fa-save mr-2"></i>ë‚´ í…œí”Œë¦¿ ê´€ë¦¬
                            </h3>

                            <div class="space-y-3">
                                <div class="flex gap-2">
                                    <input type="text" id="templateNameInput" 
                                        class="flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm"
                                        placeholder="í…œí”Œë¦¿ ì´ë¦„ ì…ë ¥ (ì„ íƒì‚¬í•­)">
                                    <button onclick="saveCurrentTemplate()" 
                                        class="px-4 py-2 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 transition whitespace-nowrap">
                                        <i class="fas fa-save mr-1"></i>ì´ë¦„ìœ¼ë¡œ ì €ì¥
                                    </button>
                                </div>
                                <button onclick="saveCurrentTemplateWithTimestamp()" 
                                    class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition">
                                    <i class="fas fa-clock mr-2"></i>ì„¤ì • ì €ì¥ (ë‚ ì§œ/ì‹œê°„ìœ¼ë¡œ ìë™ ì €ì¥)
                                </button>
                                <div id="savedTemplatesList" class="space-y-1 mt-3">
                                    <!-- ì €ì¥ëœ í…œí”Œë¦¿ ëª©ë¡ì´ ì—¬ê¸° í‘œì‹œë©ë‹ˆë‹¤ -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Panel - Main Workflow -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                        <!-- Progress Steps -->
                        <div class="flex mb-8">
                            <div class="progress-step active" id="step1">
                                <div class="step-circle">
                                    <i class="fas fa-link"></i>
                                </div>
                                <span class="text-xs">URL ì…ë ¥</span>
                            </div>
                            <div class="progress-step" id="step2">
                                <div class="step-circle">
                                    <i class="fas fa-file-alt"></i>
                                </div>
                                <span class="text-xs">ìŠ¤í¬ë¦½íŠ¸</span>
                            </div>
                            <div class="progress-step" id="step3">
                                <div class="step-circle">
                                    <i class="fas fa-microphone"></i>
                                </div>
                                <span class="text-xs">ìŒì„± ìƒì„±</span>
                            </div>
                            <div class="progress-step" id="step4">
                                <div class="step-circle">
                                    <i class="fas fa-video"></i>
                                </div>
                                <span class="text-xs">ì˜ìƒ ìƒì„±</span>
                            </div>
                        </div>

                        <!-- Step 1: Blog/Article URL Input -->
                        <div id="urlInputSection">
                            <h2 class="text-2xl font-bold text-gray-800 mb-4">
                                <i class="fas fa-link mr-2 text-blue-600"></i>
                                ì½˜í…ì¸  í¬ë¡¤ë§
                            </h2>
                            
                            <!-- Tab Navigation -->
                            <div class="flex border-b border-gray-300 mb-4">
                                <button id="blogTab" onclick="switchCrawlTab('blog')" 
                                    class="flex-1 py-3 px-4 text-center font-semibold transition border-b-2 border-blue-600 text-blue-600">
                                    <i class="fas fa-blog mr-2"></i>ë¸”ë¡œê·¸
                                </button>
                                <button id="articleTab" onclick="switchCrawlTab('article')" 
                                    class="flex-1 py-3 px-4 text-center font-semibold transition border-b-2 border-transparent text-gray-600 hover:text-gray-800">
                                    <i class="fas fa-newspaper mr-2"></i>ê¸°ì‚¬
                                </button>
                            </div>
                            
                            <!-- Blog Crawl Section -->
                            <div id="blogCrawlSection">
                                <div class="mb-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">
                                        <i class="fas fa-blog mr-1 text-blue-500"></i>ë¸”ë¡œê·¸ ê¸€ URL
                                    </label>
                                    <input type="url" id="blogUrl" 
                                        class="w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        placeholder="https://blog.example.com/your-post">
                                    <p class="text-xs text-gray-500 mt-1">
                                        <i class="fas fa-info-circle mr-1"></i>ë„¤ì´ë²„ ë¸”ë¡œê·¸, í‹°ìŠ¤í† ë¦¬, ì›Œë“œí”„ë ˆìŠ¤ ë“± ì§€ì›
                                    </p>
                                </div>

                                <button onclick="crawlBlog()" 
                                    class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-6 rounded-md hover:from-blue-700 hover:to-purple-700 transition font-semibold">
                                    <i class="fas fa-download mr-2"></i>ë¸”ë¡œê·¸ í¬ë¡¤ë§ ì‹œì‘
                                </button>
                            </div>
                            
                            <!-- Article Crawl Section -->
                            <div id="articleCrawlSection" class="hidden">
                                <div class="mb-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">
                                        <i class="fas fa-newspaper mr-1 text-blue-500"></i>ë‰´ìŠ¤ ê¸°ì‚¬ URL
                                    </label>
                                    <input type="url" id="articleUrl" 
                                        class="w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        placeholder="https://www.eanews.kr/news/893944">
                                    <p class="text-xs text-gray-500 mt-1">
                                        <i class="fas fa-info-circle mr-1"></i>ëŒ€ë¶€ë¶„ì˜ ë‰´ìŠ¤ ì‚¬ì´íŠ¸ ì§€ì›
                                    </p>
                                </div>

                                <button onclick="crawlArticle()" 
                                    class="w-full bg-gradient-to-r from-orange-600 to-red-600 text-white py-3 px-6 rounded-md hover:from-orange-700 hover:to-red-700 transition font-semibold">
                                    <i class="fas fa-download mr-2"></i>ê¸°ì‚¬ í¬ë¡¤ë§ ì‹œì‘
                                </button>
                            </div>
                            
                            <!-- Crawled Images Container -->
                            <div id="crawledImagesContainer" class="hidden mt-4">
                                <!-- Dynamic content populated by displayCrawledImages() -->
                            </div>
                        </div>

                        <!-- Step 2: Script Preview -->
                        <div id="scriptSection" class="hidden">
                            <h2 class="text-2xl font-bold text-gray-800 mb-4">
                                <i class="fas fa-file-alt mr-2 text-green-600"></i>
                                ìƒì„±ëœ ìŠ¤í¬ë¦½íŠ¸
                            </h2>
                            
                            <div class="mb-4 p-4 bg-gray-50 rounded-lg">
                                <h3 class="font-semibold text-gray-700 mb-2">ì œëª©</h3>
                                <p id="blogTitle" class="text-gray-800 mb-4"></p>
                                
                                <h3 class="font-semibold text-gray-700 mb-2">ìŠ¤í¬ë¦½íŠ¸</h3>
                                <textarea id="scriptText" rows="8" 
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    onchange="updateScriptParts()"></textarea>
                                
                                <button id="analyzeScriptBtn" onclick="analyzeScriptParts()" 
                                    class="mt-3 w-full px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white text-base font-bold rounded-lg hover:from-purple-700 hover:to-pink-700 transition shadow-lg hover:shadow-xl transform hover:scale-105">
                                    <i class="fas fa-magic mr-2"></i>íŒŒíŠ¸ë³„ ì´ë¯¸ì§€ ë§¤í•‘
                                </button>
                                <p class="text-xs text-gray-500 mt-2">
                                    <i class="fas fa-info-circle mr-1"></i>
                                    ìŠ¤í¬ë¦½íŠ¸ë¥¼ íŒŒíŠ¸ë¡œ ë¶„í• í•˜ê³  ê° íŒŒíŠ¸ì— ì´ë¯¸ì§€ë¥¼ í• ë‹¹í•©ë‹ˆë‹¤
                                </p>
                            </div>

                            <!-- Script Parts & Image Mapping -->
                            <div id="scriptPartsContainer" class="hidden mb-4">
                                <!-- Dynamic content populated by displayScriptParts() -->
                            </div>

                            <div class="flex gap-3">
                                <button onclick="generateAudio()" 
                                    class="flex-1 bg-green-600 text-white py-3 px-6 rounded-md hover:bg-green-700 transition font-semibold">
                                    <i class="fas fa-microphone mr-2"></i>ìŒì„± ìƒì„±
                                </button>
                                <button onclick="resetWorkflow()" 
                                    class="bg-gray-500 text-white py-3 px-6 rounded-md hover:bg-gray-600 transition">
                                    <i class="fas fa-redo mr-2"></i>ë‹¤ì‹œ ì‹œì‘
                                </button>
                            </div>
                        </div>

                        <!-- Step 3: Audio Generated -->
                        <div id="audioSection" class="hidden">
                            <h2 class="text-2xl font-bold text-gray-800 mb-4">
                                <i class="fas fa-microphone mr-2 text-purple-600"></i>
                                ìŒì„± ìƒì„± ì™„ë£Œ
                            </h2>
                            
                            <div class="mb-4 p-4 bg-purple-50 rounded-lg">
                                <audio id="audioPlayer" controls class="w-full mb-4"></audio>
                                <p class="text-sm text-gray-600">ìŒì„±ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ì˜ìƒì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                            </div>

                            <button onclick="generateVideo()" 
                                class="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 px-6 rounded-md hover:from-purple-700 hover:to-pink-700 transition font-semibold">
                                <i class="fas fa-video mr-2"></i>ì˜ìƒ ìƒì„±
                            </button>
                        </div>

                        <!-- Step 4: Video Generated -->
                        <div id="videoSection" class="hidden">
                            <h2 class="text-2xl font-bold text-gray-800 mb-4">
                                <i class="fas fa-check-circle mr-2 text-green-600"></i>
                                ì˜ìƒ ìƒì„± ì™„ë£Œ!
                            </h2>
                            
                            <div class="mb-4 p-4 bg-green-50 rounded-lg">
                                <video id="videoPlayer" controls class="w-full rounded-lg mb-4"></video>
                                
                                <!-- Audio Player Section (Hidden by default) -->
                                <div id="audioSection" class="mb-4" style="display: none;">
                                    <h4 class="text-sm font-semibold text-gray-700 mb-2">
                                        <i class="fas fa-volume-up mr-2"></i>ìƒì„±ëœ ìŒì„±
                                    </h4>
                                    <audio id="audioPlayer" controls class="w-full"></audio>
                                </div>
                                
                                <div class="flex gap-3">
                                    <a id="downloadLink" download 
                                        class="flex-1 bg-blue-600 text-white text-center py-3 px-6 rounded-md hover:bg-blue-700 transition font-semibold">
                                        <i class="fas fa-download mr-2"></i>ë‹¤ìš´ë¡œë“œ
                                    </a>
                                    <button onclick="resetWorkflow()" 
                                        class="bg-gray-500 text-white py-3 px-6 rounded-md hover:bg-gray-600 transition">
                                        <i class="fas fa-plus mr-2"></i>ìƒˆë¡œ ë§Œë“¤ê¸°
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Loading Overlay -->
                        <div id="loadingOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                            <div class="bg-white rounded-lg p-8 max-w-md">
                                <div class="text-center">
                                    <i class="fas fa-spinner loading text-4xl text-blue-600 mb-4"></i>
                                    <h3 class="text-xl font-bold text-gray-800 mb-2" id="loadingTitle">ì²˜ë¦¬ì¤‘...</h3>
                                    <p class="text-gray-600" id="loadingMessage">ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Projects -->
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-history mr-2 text-gray-600"></i>
                            ìµœê·¼ í”„ë¡œì íŠ¸
                        </h2>
                        <div id="projectsList" class="space-y-2">
                            <p class="text-gray-500 text-sm">ì•„ì§ ìƒì„±ëœ í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Image Preview Modal -->
        <div id="imageModal" class="hidden fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4" onclick="closeImageModal()">
            <div class="relative max-w-7xl max-h-full" onclick="event.stopPropagation()">
                <button onclick="closeImageModal()" 
                    class="absolute -top-12 right-0 text-white text-2xl hover:text-gray-300 transition">
                    <i class="fas fa-times-circle"></i>
                </button>
                <img id="modalImage" src="" alt="Preview" class="max-w-full max-h-screen object-contain rounded-lg shadow-2xl">
                <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black bg-opacity-75 text-white px-4 py-2 rounded-lg text-sm">
                    í´ë¦­í•˜ì—¬ ë‹«ê¸°
                </div>
            </div>
        </div>

        <!-- Caption Preview Modal -->
        <div id="captionPreviewModal" class="hidden fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4">
            <div class="relative w-full max-w-md bg-black rounded-lg overflow-hidden shadow-2xl" style="aspect-ratio: 9/16;">
                <button onclick="closeCaptionPreview()" 
                    class="absolute top-4 right-4 z-10 text-white text-2xl hover:text-gray-300 transition">
                    <i class="fas fa-times-circle"></i>
                </button>
                <div id="captionPreviewContent" class="relative w-full h-full flex items-center justify-center">
                    <!-- ë¯¸ë¦¬ë³´ê¸° ë‚´ìš©ì´ ì—¬ê¸° í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"></script>
        
        <!-- Load API keys from backend before app.js loads -->
        <script>
        (async function loadApiKeys() {
            try {
                const authToken = localStorage.getItem('jwt_token');
                if (!authToken) {
                    console.log('âš ï¸ No auth token, API keys not loaded');
                    return;
                }
                
                // Get userId from localStorage (saved during login)
                const userInfoStr = localStorage.getItem('user_info');
                let userId = 'admin_001'; // Default fallback
                
                if (userInfoStr) {
                    try {
                        const userInfo = JSON.parse(userInfoStr);
                        userId = userInfo.id || userId;
                        console.log('âœ… User ID from localStorage:', userId);
                    } catch (e) {
                        console.log('âš ï¸ Failed to parse user_info, using default');
                    }
                } else {
                    console.log('âš ï¸ No user_info in localStorage, using default ID');
                }
                
                // Fetch user settings
                const settingsResponse = await fetch('/api/settings/' + userId);
                if (!settingsResponse.ok) {
                    console.log('âš ï¸ Failed to load settings');
                    return;
                }
                
                const settingsData = await settingsResponse.json();
                
                if (settingsData.success && settingsData.data) {
                    const settings = settingsData.data;
                    
                    // Fill hidden input fields
                    document.getElementById('geminiApiKey').value = settings.gemini_api_key || '';
                    document.getElementById('minimaxApiKey').value = settings.minimax_api_key || '';
                    document.getElementById('minimaxGroupId').value = settings.minimax_group_id || '';
                    document.getElementById('shotstackApiKey').value = settings.shotstack_api_key || '';
                    
                    console.log('âœ… API keys loaded successfully from settings');
                    console.log('   - Gemini:', settings.gemini_api_key ? 'âœ“' : 'âœ—');
                    console.log('   - Minimax:', settings.minimax_api_key ? 'âœ“' : 'âœ—');
                    console.log('   - Minimax Group ID:', settings.minimax_group_id ? 'âœ“' : 'âœ—');
                    console.log('   - Shotstack:', settings.shotstack_api_key ? 'âœ“' : 'âœ—');
                } else {
                    console.log('âš ï¸ No settings found for user');
                }
            } catch (error) {
                console.error('âŒ Failed to load API keys:', error);
            }
        })();

        // êµ¬ë… ìƒíƒœ í™•ì¸ ë° í‘œì‹œ
        async function checkSubscriptionStatus() {
            try {
                const authToken = localStorage.getItem('jwt_token') || localStorage.getItem('auth_token');
                if (!authToken) {
                    console.log('âš ï¸ No auth token for subscription check');
                    return;
                }
                
                const response = await fetch('/api/subscription/status', { 
                    credentials: 'include',
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });
                if (!response.ok) {
                    console.log('âš ï¸ Subscription status check failed');
                    return;
                }

                const result = await response.json();
                const badge = document.getElementById('subscriptionBadge');
                const text = document.getElementById('subscriptionText');
                const days = document.getElementById('subscriptionDays');
                const banner = document.getElementById('subscriptionBanner');

                if (!badge || !text || !days) return;

                // API ì‘ë‹µ êµ¬ì¡°: { success: true, data: { status, daysLeft, ... } }
                const statusData = result.data || result;
                const statusType = statusData.status;

                if (statusType === 'trial') {
                    // ë¬´ë£Œ ì²´í—˜ ì¤‘: ë°°ì§€ í‘œì‹œ, ë°°ë„ˆ ìˆ¨ê¹€
                    badge.classList.remove('hidden');
                    if (banner) banner.classList.add('hidden');
                    badge.className = 'px-4 py-2 rounded-lg shadow-md cursor-pointer hover:shadow-lg transition bg-gradient-to-r from-blue-500 to-purple-500 text-white';
                    text.textContent = 'ë¬´ë£Œ ì²´í—˜';
                    days.textContent = statusData.daysLeft ? `${statusData.daysLeft}ì¼ ë‚¨ìŒ` : '';
                } else if (statusType === 'active') {
                    // êµ¬ë… ì¤‘: ë°°ì§€ í‘œì‹œ, ë°°ë„ˆ ìˆ¨ê¹€
                    badge.classList.remove('hidden');
                    if (banner) banner.classList.add('hidden');
                    badge.className = 'px-4 py-2 rounded-lg shadow-md cursor-pointer hover:shadow-lg transition bg-gradient-to-r from-green-500 to-emerald-500 text-white';
                    text.textContent = 'í”„ë¦¬ë¯¸ì—„';
                    const endDate = statusData.subscription_end ? new Date(statusData.subscription_end) : null;
                    if (endDate) {
                        const daysRemaining = Math.ceil((endDate - new Date()) / (1000 * 60 * 60 * 24));
                        days.textContent = `${daysRemaining}ì¼ ë‚¨ìŒ`;
                    }
                } else if (statusType === 'expired') {
                    // êµ¬ë… ë§Œë£Œ: ë°°ì§€ ìˆ¨ê¹€, ë°°ë„ˆ í‘œì‹œ
                    badge.classList.add('hidden');
                    if (banner) banner.classList.remove('hidden');
                }

                console.log('âœ… Subscription status loaded:', statusType);
            } catch (error) {
                console.error('âŒ Failed to load subscription status:', error);
            }
        }

        // ë¡œê·¸ì¸ ìƒíƒœì¼ ë•Œ êµ¬ë… ìƒíƒœ í™•ì¸
        const authLoggedIn = document.getElementById('authLoggedIn');
        if (authLoggedIn && !authLoggedIn.classList.contains('hidden')) {
            checkSubscriptionStatus();
        }

        // ì¸ì¦ ìƒíƒœê°€ ë³€ê²½ë˜ë©´ êµ¬ë… ìƒíƒœë„ í™•ì¸
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                if (mutation.target.id === 'authLoggedIn' && !mutation.target.classList.contains('hidden')) {
                    checkSubscriptionStatus();
                }
            });
        });

        const authLoggedInElement = document.getElementById('authLoggedIn');
        if (authLoggedInElement) {
            observer.observe(authLoggedInElement, { attributes: true, attributeFilter: ['class'] });
        }

        // í”Œëœë³´ê¸° ëª¨ë‹¬ ì—´ê¸°
        function showPricingModal() {
            document.getElementById('pricingModal').classList.remove('hidden');
            document.getElementById('pricingModal').classList.add('flex');
            document.body.style.overflow = 'hidden';
        }

        // í”Œëœë³´ê¸° ëª¨ë‹¬ ë‹«ê¸°
        function closePricingModal() {
            document.getElementById('pricingModal').classList.add('hidden');
            document.getElementById('pricingModal').classList.remove('flex');
            document.body.style.overflow = 'auto';
        }

        // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closePricingModal();
            }
        });

        // ëª¨ë‹¬ ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
        document.getElementById('pricingModal')?.addEventListener('click', function(e) {
            if (e.target === this) {
                closePricingModal();
            }
        });
        </script>
        
        <!-- í”Œëœë³´ê¸° ëª¨ë‹¬ -->
        <div id="pricingModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
            <div class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6 rounded-t-2xl">
                    <div class="flex justify-between items-center">
                        <div>
                            <h2 class="text-3xl font-bold mb-2">
                                <i class="fas fa-crown mr-2"></i>
                                êµ¬ë… í”Œëœ
                            </h2>
                            <p class="text-purple-100">í”„ë¦¬ë¯¸ì—„ ê¸°ëŠ¥ì„ ì´ìš©í•˜ê³  ë¬´ì œí•œ ì˜ìƒì„ ìƒì„±í•˜ì„¸ìš”!</p>
                        </div>
                        <button onclick="closePricingModal()" class="text-white hover:text-gray-200 text-3xl font-bold">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>

                <div class="p-8">
                    <!-- ë¬´ë£Œ ì²´í—˜ ì•ˆë‚´ -->
                    <div class="bg-blue-50 border-2 border-blue-300 rounded-xl p-6 mb-8">
                        <div class="flex items-center gap-3 mb-3">
                            <i class="fas fa-gift text-4xl text-blue-600"></i>
                            <div>
                                <h3 class="text-2xl font-bold text-blue-900">3ì¼ ë¬´ë£Œ ì²´í—˜</h3>
                                <p class="text-blue-700">íšŒì›ê°€ì… ì‹œ ìë™ìœ¼ë¡œ ì‹œì‘ë©ë‹ˆë‹¤!</p>
                            </div>
                        </div>
                        <ul class="space-y-2 text-blue-800">
                            <li><i class="fas fa-check-circle text-blue-600 mr-2"></i>ëª¨ë“  í”„ë¦¬ë¯¸ì—„ ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥</li>
                            <li><i class="fas fa-check-circle text-blue-600 mr-2"></i>ë¬´ì œí•œ ì˜ìƒ ìƒì„±</li>
                            <li><i class="fas fa-check-circle text-blue-600 mr-2"></i>ì²´í—˜ í›„ ììœ ë¡­ê²Œ êµ¬ë… ì„ íƒ</li>
                        </ul>
                    </div>

                    <!-- êµ¬ë… í”Œëœ -->
                    <div class="grid md:grid-cols-2 gap-6 mb-8">
                        <!-- ì›”ê°„ í”Œëœ -->
                        <div class="border-2 border-gray-300 rounded-xl p-6 hover:border-orange-500 hover:shadow-xl transition">
                            <div class="text-center mb-6">
                                <h3 class="text-2xl font-bold text-gray-800 mb-2">ì›”ê°„ í”Œëœ</h3>
                                <div class="flex items-baseline justify-center gap-2">
                                    <span class="text-5xl font-bold text-orange-600">33,000</span>
                                    <span class="text-2xl text-gray-600">ì›</span>
                                </div>
                                <p class="text-gray-500 mt-2">/ ì›”</p>
                            </div>
                            
                            <ul class="space-y-3 mb-6">
                                <li class="flex items-start gap-2">
                                    <i class="fas fa-check text-green-600 mt-1"></i>
                                    <span class="text-gray-700">ë¬´ì œí•œ ì˜ìƒ ìƒì„±</span>
                                </li>
                                <li class="flex items-start gap-2">
                                    <i class="fas fa-check text-green-600 mt-1"></i>
                                    <span class="text-gray-700">ëª¨ë“  í”„ë¦¬ë¯¸ì—„ ê¸°ëŠ¥</span>
                                </li>
                                <li class="flex items-start gap-2">
                                    <i class="fas fa-check text-green-600 mt-1"></i>
                                    <span class="text-gray-700">ê³ í™”ì§ˆ ë‹¤ìš´ë¡œë“œ</span>
                                </li>
                                <li class="flex items-start gap-2">
                                    <i class="fas fa-check text-green-600 mt-1"></i>
                                    <span class="text-gray-700">ìš°ì„  ê³ ê° ì§€ì›</span>
                                </li>
                            </ul>
                            
                            <a href="/payment.html?plan=monthly" class="block w-full py-4 bg-gradient-to-r from-yellow-500 to-orange-600 text-white text-center rounded-lg hover:from-yellow-600 hover:to-orange-700 transition font-bold text-lg shadow-lg">
                                <i class="fas fa-shopping-cart mr-2"></i>
                                ì›”ê°„ êµ¬ë…í•˜ê¸°
                            </a>
                        </div>

                        <!-- ì—°ê°„ í”Œëœ (í• ì¸) -->
                        <div class="border-4 border-green-500 rounded-xl p-6 hover:shadow-2xl transition relative overflow-hidden">
                            <div class="absolute top-4 right-4 bg-green-500 text-white px-4 py-1 rounded-full text-sm font-bold">
                                25% í• ì¸
                            </div>
                            
                            <div class="text-center mb-6">
                                <h3 class="text-2xl font-bold text-gray-800 mb-2">ì—°ê°„ í”Œëœ</h3>
                                <div class="flex items-baseline justify-center gap-2">
                                    <span class="text-5xl font-bold text-green-600">297,000</span>
                                    <span class="text-2xl text-gray-600">ì›</span>
                                </div>
                                <p class="text-gray-500 mt-2">/ ë…„</p>
                                <p class="text-green-600 font-bold mt-2">
                                    <span class="line-through text-gray-400 text-sm">396,000ì›</span>
                                    <span class="ml-2">99,000ì› ì ˆì•½!</span>
                                </p>
                            </div>
                            
                            <ul class="space-y-3 mb-6">
                                <li class="flex items-start gap-2">
                                    <i class="fas fa-check text-green-600 mt-1"></i>
                                    <span class="text-gray-700">ì›”ê°„ í”Œëœì˜ ëª¨ë“  ê¸°ëŠ¥</span>
                                </li>
                                <li class="flex items-start gap-2">
                                    <i class="fas fa-star text-green-600 mt-1"></i>
                                    <span class="text-gray-700 font-bold">25% í• ì¸ í˜œíƒ</span>
                                </li>
                                <li class="flex items-start gap-2">
                                    <i class="fas fa-star text-green-600 mt-1"></i>
                                    <span class="text-gray-700 font-bold">ì¶”ê°€ ê¸°ëŠ¥ ìš°ì„  ì œê³µ</span>
                                </li>
                                <li class="flex items-start gap-2">
                                    <i class="fas fa-star text-green-600 mt-1"></i>
                                    <span class="text-gray-700 font-bold">1:1 ì „ë‹´ ì§€ì›</span>
                                </li>
                            </ul>
                            
                            <a href="/payment.html?plan=annual" class="block w-full py-4 bg-gradient-to-r from-green-500 to-emerald-600 text-white text-center rounded-lg hover:from-green-600 hover:to-emerald-700 transition font-bold text-lg shadow-lg">
                                <i class="fas fa-crown mr-2"></i>
                                ì—°ê°„ êµ¬ë…í•˜ê¸° (25% í• ì¸)
                            </a>
                        </div>
                    </div>

                    <!-- ê²°ì œ ë°©ë²• ì•ˆë‚´ -->
                    <div class="bg-gray-50 rounded-xl p-6">
                        <h4 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                            <i class="fas fa-credit-card text-blue-600"></i>
                            ì§€ì›í•˜ëŠ” ê²°ì œ ë°©ë²•
                        </h4>
                        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">
                            <div class="text-center p-3 bg-white rounded-lg shadow">
                                <i class="fas fa-comments text-3xl text-yellow-500 mb-2"></i>
                                <p class="text-sm font-medium">ì¹´ì¹´ì˜¤í˜ì´</p>
                            </div>
                            <div class="text-center p-3 bg-white rounded-lg shadow">
                                <i class="fas fa-n text-3xl text-green-600 mb-2"></i>
                                <p class="text-sm font-medium">ë„¤ì´ë²„í˜ì´</p>
                            </div>
                            <div class="text-center p-3 bg-white rounded-lg shadow">
                                <i class="fas fa-credit-card text-3xl text-blue-600 mb-2"></i>
                                <p class="text-sm font-medium">ì‹ ìš©ì¹´ë“œ</p>
                            </div>
                            <div class="text-center p-3 bg-white rounded-lg shadow">
                                <i class="fas fa-university text-3xl text-gray-600 mb-2"></i>
                                <p class="text-sm font-medium">ë¬´í†µì¥ì…ê¸ˆ</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <script src="/static/audio-sync-helper.js?v=20251125001"></script>
        <script src="/static/app.js?v=20251125001"></script>
    </body>
    </html>
  